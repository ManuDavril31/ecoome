<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Radios y Emisoras de Montería – En vivo</title>
    <meta
      name="description"
      content="Escucha en vivo radios y emisoras de Montería, Córdoba. Reproductores integrados y enlaces a los sitios oficiales."
    />
    <link rel="stylesheet" href="styles.css" />
    <style>
      .radio-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.25rem;
      }
      .radio-card {
        position: relative;
        background: linear-gradient(180deg, #ffffff 0%, #fbfcff 100%);
        border: 1px solid var(--border, #e5e7eb);
        border-radius: 16px;
        padding: 1rem;
        box-shadow: var(--shadow-1, 0 2px 10px rgba(0, 0, 0, 0.06));
        display: flex;
        flex-direction: column;
        gap: 0.6rem;
        cursor: pointer;
        transition: transform 160ms ease, box-shadow 160ms ease,
          border-color 160ms ease, background 160ms ease;
        will-change: transform, box-shadow;
      }
      .radio-card header {
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }
      .radio-logo {
        width: 56px;
        height: 56px;
        object-fit: contain;
        border-radius: 12px;
        background: #f7f9ff;
        border: 1px solid var(--border, #e5e7eb);
        box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
      }
      .radio-name {
        margin: 0;
        font-weight: 800;
        font-size: 1.05rem;
        letter-spacing: 0.2px;
      }
      /* Indicador de estado (con o sin stream) */
      .radio-card[data-stream] .radio-name::before,
      .radio-card:not([data-stream]) .radio-name::before {
        content: "";
        display: inline-block;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        margin-right: 0.5rem;
        vertical-align: middle;
      }
      .radio-card[data-stream] .radio-name::before {
        background: #10b981; /* verde */
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.15);
      }
      .radio-card:not([data-stream]) .radio-name::before {
        background: #9ca3af; /* gris */
        box-shadow: 0 0 0 3px rgba(156, 163, 175, 0.12);
      }
      .radio-meta {
        margin: 0;
        color: var(--muted, #6b7280);
        font-size: 0.92rem;
      }
      .radio-meta:empty {
        display: none;
      }
      .radio-actions {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
      }
      audio {
        width: 100%;
        height: 32px;
      }
      @media (hover: hover) {
        .radio-card:hover {
          transform: translateY(-2px);
          border-color: rgba(59, 130, 246, 0.35);
          box-shadow: var(--shadow-2, 0 10px 24px rgba(0, 0, 0, 0.08));
          background: linear-gradient(180deg, #ffffff 0%, #f8fbff 100%);
        }
      }
      .radio-card:active {
        transform: translateY(0);
      }
      .radio-card:focus-visible {
        outline: 3px solid rgba(59, 130, 246, 0.45);
        outline-offset: 2px;
      }

      /* Reproductor maestro fijo */
      .sticky-player {
        position: sticky;
        top: 0;
        z-index: 10;
        background: #fff;
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 0.75rem 1rem;
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 1rem;
        box-shadow: var(--shadow-1);
        backdrop-filter: saturate(1.2) blur(3px);
      }
      .player-logo {
        width: 48px;
        height: 48px;
        object-fit: contain;
        border-radius: 10px;
        background: #f7f9ff;
        border: 1px solid var(--border);
      }
      .player-meta {
        flex: 1;
        min-width: 140px;
      }
      .player-title {
        font-weight: 800;
      }
      .player-subtitle {
        color: var(--muted);
        font-size: 0.95rem;
      }
      /* .player-actions eliminado */
      .radio-card.selected {
        outline: 2px solid var(--primary, #3b82f6);
        border-color: var(--primary, #3b82f6);
        box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.12),
          var(--shadow-1, 0 2px 10px rgba(0, 0, 0, 0.06));
        background: linear-gradient(180deg, #ffffff 0%, #f3f8ff 100%);
      }
      /* Ocultar reproductores internos para usar el maestro */
      .radio-card audio {
        display: none;
      }
      @media (max-width: 640px) {
        .sticky-player {
          flex-wrap: wrap;
        }
        .sticky-player audio {
          width: 100%;
        }
      }
      /* SEO helpers */
      .lead {
        font-size: 1.02rem;
        color: var(--text, #111827);
      }
      .muted {
        color: var(--muted, #6b7280);
      }
      .faq {
        margin-top: 2rem;
      }
      .faq h2 {
        margin-bottom: 0.5rem;
      }
      .faq-list {
        margin: 0;
        padding: 0;
      }
      .faq-list dt {
        font-weight: 700;
        margin-top: 0.85rem;
      }
      .faq-list dd {
        margin: 0.25rem 0 0.5rem 0;
        color: var(--muted, #6b7280);
      }
    </style>
  </head>
  <body>
    <main class="container">
      <nav class="breadcrumbs">
        <a href="index.html">Inicio</a> / <span>Radios en vivo</span>
      </nav>
      <section>
        <h1 class="section-title">Radios y Emisoras de Montería – En vivo</h1>
        <p class="lead">
          Escucha radios y emisoras de Montería (Córdoba) en vivo por internet.
          Reproduce gratis música, noticias, deportes y entretenimiento desde
          cualquier dispositivo, sin salir de esta página.
        </p>
        <p class="muted" style="margin-top: -0.25rem">
          Elige una emisora y el reproductor superior iniciará automáticamente.
          Si un stream no está disponible, verás el aviso «Sin streaming
          disponible» mientras actualizamos las direcciones oficiales.
        </p>
        <!-- Reproductor maestro -->
        <div class="sticky-player" id="master-player" aria-live="polite">
          <img
            id="player-logo"
            class="player-logo"
            src="https://cdn-icons-png.flaticon.com/512/3103/3103423.png"
            alt="Logo emisora"
          />
          <div class="player-meta">
            <div id="player-title" class="player-title">
              Selecciona una emisora
            </div>
            <div id="player-subtitle" class="player-subtitle"></div>
          </div>
          <audio id="master-audio" controls preload="none" playsinline></audio>
        </div>
        <h2 style="margin-top: 1rem">Listado de emisoras de Montería</h2>
        <div class="radio-grid" id="radio-grid"></div>
        <section class="faq" aria-labelledby="faq-title">
          <h2 id="faq-title">Preguntas frecuentes</h2>
          <dl class="faq-list">
            <dt>¿Cómo escuchar las emisoras de Montería online?</dt>
            <dd>
              Haz clic en la tarjeta de la emisora; el reproductor superior se
              activa al instante.
            </dd>
            <dt>¿Por qué alguna emisora no suena?</dt>
            <dd>
              Algunas radios cambian su URL o restringen la reproducción
              externa. Vamos incorporando los streams oficiales cuando están
              disponibles.
            </dd>
            <dt>¿Puedo escuchar desde el móvil?</dt>
            <dd>
              Sí. La página funciona en teléfonos y tablets; puede que el
              sistema solicite tocar una vez para iniciar el audio.
            </dd>
            <dt>¿El streaming consume datos?</dt>
            <dd>
              Sí, el audio en vivo usa datos. Recomendamos Wi‑Fi si tu plan
              móvil es limitado.
            </dd>
          </dl>
        </section>
      </section>
    </main>
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
          {
            "@type": "Question",
            "name": "¿Cómo escuchar las emisoras de Montería online?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Haz clic en la tarjeta de la emisora; el reproductor superior se activa al instante."
            }
          },
          {
            "@type": "Question",
            "name": "¿Por qué alguna emisora no suena?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Algunas radios cambian su URL o restringen la reproducción externa. Vamos incorporando los streams oficiales cuando están disponibles."
            }
          },
          {
            "@type": "Question",
            "name": "¿Puedo escuchar desde el móvil?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Sí. La página funciona en teléfonos y tablets; puede que el sistema solicite tocar una vez para iniciar el audio."
            }
          },
          {
            "@type": "Question",
            "name": "¿El streaming consume datos?",
            "acceptedAnswer": {
              "@type": "Answer",
              "text": "Sí, el audio en vivo usa datos. Recomendamos Wi‑Fi si tu plan móvil es limitado."
            }
          }
        ]
      }
    </script>
    <script>
      (function () {
        const grid = document.getElementById("radio-grid");
        const audio = document.getElementById("master-audio");
        const titleEl = document.getElementById("player-title");
        const subEl = document.getElementById("player-subtitle");
        const logoEl = document.getElementById("player-logo");

        function createCard(item) {
          const art = document.createElement("article");
          art.className = "radio-card";
          if (item.streaming) art.dataset.stream = item.streaming;
          // data-name/freq opcionales (no están en JSON actual)
          art.innerHTML = `
            <header>
              <img class="radio-logo" src="${item.imagen || ""}" alt="${
            item.titulo || "Emisora"
          }" />
              <div>
                <h3 class="radio-name">${item.titulo || "Emisora"}</h3>
                <p class="radio-meta">${item.frecuencia || ""}</p>
              </div>
            </header>
            ${
              item.streaming
                ? `<audio controls preload="none" src="${item.streaming}"></audio>`
                : `<audio controls preload="none"></audio>`
            }
          `;
          return art;
        }

        function injectStationsSchema(items = []) {
          try {
            const list = items.map((it, idx) => {
              // Extraer frecuencia si viene en el título, p.ej. "(94.1 FM)"
              const m = (it.titulo || "").match(
                /([0-9]{2,3}(?:\.[0-9])?)\s*(FM|AM)/i
              );
              const freq = m ? `${m[1]} ${m[2].toUpperCase()}` : undefined;
              const station = {
                "@type": "RadioStation",
                name: it.titulo || "Emisora",
                image: it.imagen || undefined,
                areaServed: "Montería, Córdoba, CO",
              };
              if (freq) station.broadcastFrequency = freq;
              if (it.streaming)
                station.broadcastService = {
                  "@type": "BroadcastService",
                  name: it.titulo || "Stream",
                  broadcastFrequency: freq,
                  broadcastDisplayName: it.titulo,
                  additionalProperty: [
                    {
                      "@type": "PropertyValue",
                      name: "streamUrl",
                      value: it.streaming,
                    },
                  ],
                };
              return { "@type": "ListItem", position: idx + 1, item: station };
            });
            const data = {
              "@context": "https://schema.org",
              "@type": "ItemList",
              name: "Emisoras de Montería en vivo",
              itemListElement: list,
            };
            const prev = document.getElementById("stations-schema");
            if (prev) prev.remove();
            const s = document.createElement("script");
            s.type = "application/ld+json";
            s.id = "stations-schema";
            s.textContent = JSON.stringify(data);
            document.head.appendChild(s);
          } catch (e) {
            /* noop */
          }
        }

        async function loadStations() {
          try {
            const res = await fetch("emisoras.json", { cache: "no-store" });
            if (!res.ok) throw new Error("No se pudo cargar emisoras.json");
            const items = await res.json();
            grid.innerHTML = "";
            items.forEach((it) => grid.appendChild(createCard(it)));
            injectStationsSchema(items);
          } catch (err) {
            // Si falla la carga, dejar el grid vacío pero no romper
            console.warn("emisoras.json no disponible:", err);
          }
        }

        function handleCard(card) {
          if (!card) return;
          const name =
            card.querySelector(".radio-name")?.textContent?.trim() ||
            card.dataset.name ||
            "Emisora";
          const meta =
            card.querySelector(".radio-meta")?.textContent?.trim() ||
            card.dataset.freq ||
            "";
          const logo =
            card.querySelector(".radio-logo")?.getAttribute("src") ||
            card.dataset.logo ||
            "";
          const stream =
            card.dataset.stream ||
            card.querySelector("audio")?.getAttribute("src") ||
            "";

          titleEl.textContent = name;
          subEl.textContent = meta;
          if (logo) logoEl.src = logo;

          if (stream) {
            try {
              if (audio.src !== stream) {
                audio.pause();
                audio.src = stream;
                audio.load();
              }
              const p = audio.play();
              if (p && typeof p.then === "function") {
                p.catch(() => {
                  const onCanPlay = () => {
                    audio.play().catch(() => {});
                    audio.removeEventListener("canplay", onCanPlay);
                  };
                  audio.addEventListener("canplay", onCanPlay);
                });
              }
            } catch (_) {}
          } else {
            audio.pause();
            audio.removeAttribute("src");
            audio.load();
            subEl.textContent =
              (meta ? `${meta} — ` : "") + "Sin streaming disponible";
          }

          grid
            .querySelectorAll(".radio-card.selected")
            .forEach((el) => el.classList.remove("selected"));
          card.classList.add("selected");
        }

        // Delegación de eventos para clicks en cards
        grid.addEventListener("click", (e) => {
          const card = e.target.closest(".radio-card");
          if (!card || !grid.contains(card)) return;
          handleCard(card);
        });

        // Cargar emisoras desde JSON
        loadStations();
      })();
    </script>
  </body>
</html>
